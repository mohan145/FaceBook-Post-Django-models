{
  "swagger": "2.0",
  "host": "127.0.0.1:8000",
  "basePath": "/api/fbpost/",
  "info": {
    "version": "1.0.0",
    "title": "FaceBook Post API",
    "description": "An API spec for a FaceBook Post"
  },
  "schemes": [
    "https",
    "http"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "securityDefinitions": {
    "oauth": {
      "tokenUrl": "http://auth.ibtspl.com/oauth2/",
      "flow": "password",
      "scopes": {
        "read": "read users",
        "write": "create users",
        "update": "update users",
        "delete": "delete users",
        "superuser": "super user permission"
      },
      "type": "oauth2"
    }
  },
  "definitions": {

    "PostId": {
      "type": "object",
      "properties": {
        "post_id": {
          "type": "integer",
          "format": "int64"
        },

      },
      "required": [
        "post_id"
      ]
    },

    "User": {
      "type": "object",
      "properties": {
        "user_id": {
          "type": "integer",
          "format": "int64"
        },
        "profile_pic_url": {
          "type": "string"
        },
        "name": {
          "type": "string"
        }
      },
      "required": [
        "user_id",
        "name"
      ]
    },
    "Reaction": {
      "type": "object",
      "properties": {
        "reaction_id": {
          "type": "integer",
          "format": "int64"
        },
        "reaction": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "HAHA",
              "WOW",
              "LIKE",
              "SAD",
              "ANGRY",
              "LOL",
              "LOVE"
            ]
          }
        },
        "reacted_by": {
          "$ref": "#/definitions/User"
        }
      },
      "required": [
        "reaction_id",
        "reaction",
        "reacted_by"
      ]
    },
    "ReactionData": {
      "type": "object",
      "properties": {
        "count": {
          "type": "integer",
          "format": "int64"
        },
        "types": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "HAHA",
              "WOW",
              "LIKE",
              "SAD",
              "ANGRY",
              "LOL",
              "LOVE"
            ]
          }
        }
      },
      "required": [
        "count",
        "types"
      ]
    },
    "Post": {

      "allOf": [
        {
          "$ref": "#/definitions/PostId"
        },
        {
          "type": "object",
      "properties": {

        "content": {
          "type": "string"
        },
        "posted_by": {
          "$ref": "#/definitions/User"
        },
        "posted_at": {
          "type": "string",
          "format": "datetime"
        },
        "reactions": {
          "$ref": "#/definitions/ReactionData"
        },
        "comments": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Comment"
          }
        }
      },
      "required": [
        "posted_by",
        "posted_at",
        "content",
        "comments",
        "reactions"
      ]
        }
      ]


    },
    "Reply": {
      "type": "object",
      "properties": {
        "comment_id": {
          "type": "integer",
          "format": "int64"
        },
        "content": {
          "type": "string"
        },
        "commented_by": {
          "$ref": "#/definitions/User"
        },
        "commented_at": {
          "type": "string",
          "format": "datetime"
        },
        "reactions": {
          "$ref": "#/definitions/ReactionData"
        }
      },
      "required": [
        "comment_id",
        "commented_at",
        "commented_by",
        "reactions",
        "content"
      ]
    },
    "Comment": {
      "allOf": [
        {
          "$ref": "#/definitions/Reply"
        },
        {
          "type": "object",
          "properties": {
            "replies": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Reply"
              }
            },
            "replies_count": {
              "type": "integer",
              "format": "int64"
            }
          },
          "required": [
            "replies_count",
            "replies"
          ]
        }
      ]
    }
  },
  "parameters": {
    "CreateNewPostParameter": {
      "name": "CreateNewPostParameter",
      "in": "body",
      "schema": {
        "type": "object",
        "properties": {
          "post_content": {
            "type": "string"
          }
        },
        "required": [
          "post_content"
        ]
      }
    },
    "PostIdParameter": {
      "name": "post_id",
      "in": "path",
      "description": "Given Post ID",
      "type": "integer",
      "format": "int64",
      "required": true
    },
    "ReactionTypeParameter": {
      "name": "reaction_type",
      "in": "body",
      "description": "reaction type of a reaction",
      "schema": {
        "type": "object",
        "properties": {
          "reaction_type": {
            "type": "string",
            "enum": [
              "HAHA",
              "WOW",
              "LIKE",
              "SAD",
              "ANGRY",
              "LOL",
              "LOVE"
            ]
          }
        },
        "required": [
          "reaction_type"
        ]
      }
    }
  },
  "responses": {
    "CreateNewPostIDResponse": {
      "description": "Return id of a created post",
      "schema": {
        "type": "object",
        "properties": {
          "post_id": {
            "type": "integer",
            "format": "int64"
          }
        },
        "required": [
          "post_id"
        ]
      }
    },
    "GetPostResponse": {
      "description": "Return data of an entire post given a post id",
      "schema": {
        "$ref": "#/definitions/Post"
      }
    },
    "GetUserPostsListResponse": {
      "description": "Return a list of posts posted with a given user id",
      "schema": {
        "type": "array",
        "items": {
          "$ref": "#/definitions/Post"
        }
      }
    },

    "GetPostReactionsListResponse": {
      "description": "List of reactions for a given post",
      "schema": {
        "type": "array",
        "items": {
          "$ref": "#/definitions/Reaction"
        }
      }
    },

    "GetPostIdListResponse": {
      "description": "Get List of Post Ids",
      "schema": {
        "type": "array",
        "items": {
          "$ref": "#/definitions/PostId"
        }
      }
    }
  },
  "paths": {
    "/post/v1/": {
      "post": {
        "operationId": "create_post",
        "summary": "create a new post",
        "description": "create a new post with given content and returns post id",
        "security": [
          {
            "oauth": [
              "superuser"
            ]
          }
        ],
        "parameters": [
          {
            "$ref": "#/parameters/CreateNewPostParameter"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/CreateNewPostIDResponse"
          }
        }
      }
    },
    "/post/{post_id}/v1/": {
      "get": {
        "operationId": "get_post",
        "summary": "get post data",
        "description": "Return the data of post given a post id ",
        "security": [
          {
            "oauth": [
              "superuser"
            ]
          }
        ],
        "parameters": [
          {
            "$ref": "#/parameters/PostIdParameter"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/GetPostResponse"
          }
        }
      },
      "delete": {
        "summary": "delete a post",
        "operationId": "delete_post",
        "description": "delete a post given a post id",
        "security": [
          {
            "oauth": [
              "superuser"
            ]
          }
        ],
        "parameters": [
          {
            "$ref": "#/parameters/PostIdParameter"
          }
        ],
        "responses": {
          "202": {
            "description": "Deleted post with given post id"
          }
        }
      },
      "put": {
        "summary": "react to a post",
        "operationId": "react_to_post",
        "description": "react to a post with a given post id",
        "security": [
          {
            "oauth": [
              "superuser"
            ]
          }
        ],
        "parameters": [
          {
            "$ref": "#/parameters/PostIdParameter"
          },
          {
            "$ref": "#/parameters/ReactionTypeParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "Reaction updated successfully"
          }
        }
      }
    },

    "/post/{post_id}/reaction/v1/": {
      "get": {
        "summary": "get reactions to a post",
        "operationId": "get_reactions_to_a_post",
        "parameters": [
          {
            "$ref": "#/parameters/PostIdParameter"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/GetPostReactionsListResponse"
          }
        }
      }
    },


    "/user/reactedpost/": {
      "get": {
        "summary": "posts reacted by user",
        "operationId": "get_posts_reacted_by_user",
        "parameters": [

        ],
        "responses": {
          "200": {
            "$ref": "#/responses/GetPostIdListResponse"
          }
        }
      }
    },

    "/user/post/v1/": {
      "get": {
        "operationId": "get_user_posts",
        "summary": "get posts of a user",
        "description": "Return a list of posts posted by a given user",
        "security": [
          {
            "oauth": [
              "superuser"
            ]
          }
        ],
        "parameters": [
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/GetUserPostsListResponse"
          }
        }
      }
    }
  }
}
